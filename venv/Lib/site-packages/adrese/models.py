from django.db import models


# 1. Județele din România
class Judet(models.Model):
    cod = models.IntegerField(primary_key=True)
    denumire = models.CharField(max_length=255)
    ordine = models.IntegerField()
    auto = models.CharField(max_length=10)

    def __str__(self):
        return self.denumire


# 2. Tipuri de localități (comună, municipiu, sat, etc.)
class TipLocalitate(models.Model):
    cod = models.CharField(max_length=10, primary_key=True)
    denumire = models.CharField(max_length=255)

    def __str__(self):
        return self.denumire


# 3. Localitățile din România
class Localitate(models.Model):
    cod = models.IntegerField(primary_key=True)
    judet = models.ForeignKey(Judet, on_delete=models.CASCADE, related_name="localitati")
    cod_politie = models.IntegerField(null=True, blank=True)
    denumire = models.CharField(max_length=255)
    tip_localitate = models.ForeignKey(TipLocalitate, on_delete=models.SET_NULL, null=True, blank=True, related_name="localitati")
    den_scurta = models.CharField(max_length=50, null=True, blank=True)
    cod_postal = models.CharField(max_length=20, null=True, blank=True)
    loc_jud_cod = models.ForeignKey('self', on_delete=models.SET_NULL, null=True, blank=True, related_name="sub_localitati")
    loc_cod = models.IntegerField(null=True, blank=True)
    are_primarie = models.BooleanField(default=False)
    cod_fiscal_primarie = models.CharField(max_length=50, null=True, blank=True)
    cod_politie_tata = models.IntegerField(null=True, blank=True)
    sar_cod_mf = models.CharField(max_length=10, null=True, blank=True)

    def __str__(self):
        return f"{self.denumire} ({self.judet.denumire})"


# 4. Stările arterelor (activă, desființată, etc.)
class StareArtera(models.Model):
    cod = models.CharField(max_length=10, primary_key=True)
    nume_stare = models.CharField(max_length=255)

    def __str__(self):
        return self.nume_stare


# 5. Tipuri de artere (stradă, alee, bulevard, etc.)
class TipArtera(models.Model):
    cod = models.CharField(max_length=10, primary_key=True)
    denumire = models.CharField(max_length=255)

    def __str__(self):
        return self.denumire


# 6. Arterele (străzi, bulevarde)
class Artera(models.Model):
    cod = models.IntegerField(primary_key=True)
    loc_jud_cod = models.ForeignKey(Judet, on_delete=models.CASCADE, related_name="artere_judet")
    loc_cod = models.ForeignKey(Localitate, on_delete=models.CASCADE, related_name="artere_localitate")
    cod_politie = models.IntegerField(null=True, blank=True)
    denumire = models.CharField(max_length=255)
    stare = models.ForeignKey(StareArtera, on_delete=models.SET_NULL, null=True, blank=True, related_name="artere_stare")
    tip_artera = models.ForeignKey(TipArtera, on_delete=models.SET_NULL, null=True, blank=True, related_name="artere_tip")
    cod_postal = models.CharField(max_length=20, null=True, blank=True)

    def __str__(self):
        return f"{self.denumire} ({self.loc_cod.denumire})"


# 7. Istoricul arterelor
class ArteraIstoric(models.Model):
    artera_cod = models.ForeignKey(Artera, on_delete=models.CASCADE, related_name="istoric_artera")
    loc_jud_cod = models.ForeignKey(Judet, on_delete=models.CASCADE, related_name="istoric_artere_judet")
    loc_cod = models.ForeignKey(Localitate, on_delete=models.CASCADE, related_name="istoric_artere_localitate")
    denumire = models.CharField(max_length=255)
    data = models.DateField()

    def __str__(self):
        return f"Istoric {self.artera_cod.denumire} ({self.data})"


# 8. Relații între artere (când o stradă devine parte din alta)
class ArteraRelatie(models.Model):
    artera_cod_vechi = models.ForeignKey(Artera, on_delete=models.CASCADE, related_name="artere_vechi")
    artera_cod_nou = models.ForeignKey(Artera, on_delete=models.CASCADE, related_name="artere_noi")
    data = models.DateField()

    def __str__(self):
        return f"Relație între {self.artera_cod_vechi} și {self.artera_cod_nou} ({self.data})"


# 9. Relații între localități (fuzionare, alipire)
class LocalitateRelatie(models.Model):
    loc_cod = models.ForeignKey(Localitate, on_delete=models.CASCADE, related_name="relatii_locatie")
    loc_cod_nou = models.ForeignKey(Localitate, on_delete=models.CASCADE, related_name="localitati_noi")

    def __str__(self):
        return f"Relație între {self.loc_cod} și {self.loc_cod_nou}"


# 10. Istoricul localităților
class LocalitateIstoric(models.Model):
    loc_cod = models.ForeignKey(Localitate, on_delete=models.CASCADE, related_name="istoric_localitati")
    denumire = models.CharField(max_length=255)
    data = models.DateField()
    jud_cod_tata = models.ForeignKey(Judet, on_delete=models.CASCADE, related_name="judete_tata")
    cod_tata = models.ForeignKey(Localitate, on_delete=models.CASCADE, related_name="localitati_tata")

    def __str__(self):
        return f"Istoric pentru {self.denumire} ({self.data})"


# 11. Coduri Poștale pentru alte străzi
class CodPostalAlteStrazi(models.Model):
    loc_cod = models.ForeignKey(Localitate, on_delete=models.CASCADE, related_name="cod_postal_alte_strazi_localitate")
    cod = models.IntegerField(primary_key=True)
    bloc = models.CharField(max_length=50, null=True, blank=True)
    cod_postal = models.CharField(max_length=20)

    def __str__(self):
        return f"Cod postal {self.cod_postal} - Localitate: {self.loc_cod.denumire}"


# 12. Coduri Poștale pentru numere de străzi
class CodPostalNumarStrazi(models.Model):
    loc_cod = models.ForeignKey(Localitate, on_delete=models.CASCADE, related_name="cod_postal_numar_strazi_localitate")
    cod = models.IntegerField(primary_key=True)
    numar_start = models.IntegerField()
    numar_sfarsit = models.IntegerField()
    paritate = models.CharField(max_length=10)
    cod_postal = models.CharField(max_length=20)

    def __str__(self):
        return f"Cod postal {self.cod_postal} - {self.numar_start}-{self.numar_sfarsit} ({self.paritate})"

class TaraValuta(models.Model):
    cod = models.IntegerField(primary_key=True)
    stare = models.CharField(max_length=50, null=True, blank=True)
    capitala = models.CharField(max_length=255, null=True, blank=True)
    denumire = models.CharField(max_length=255)
    forma_guvern = models.CharField(max_length=255, null=True, blank=True)
    cod_tara_fiscal = models.CharField(max_length=50, null=True, blank=True)
    cod_bnr = models.CharField(max_length=50, null=True, blank=True)
    valuta = models.CharField(max_length=50, null=True, blank=True)
    cedi = models.CharField(max_length=50, null=True, blank=True)
    cod_sm = models.CharField(max_length=50, null=True, blank=True)
    ue = models.BooleanField(default=False)  # Aderare la UE (True/False)

    def __str__(self):
        return self.denumire
